import "std";

fun fibonnaci(int n) > void > int? {
    int n1 = 0;
    int n2 = 1;
    int? next = null;

    for (int i = 0; i < n; i = i + 1) {
        _ = yield n1;
        next = n1 + n2;
        n1 = n2;
        n2 = next!;
    }
}

test "finobacci generator" {
    [int] suite = [0, 1, 1, 2, 3, 5, 8, 13, 21, 34];
    int i = 0;
    foreach (int n in &fibonnaci(10)) {
        assert(suite[i] == n, message: "could iterate over fiber");

        i = i + 1;
    }
}