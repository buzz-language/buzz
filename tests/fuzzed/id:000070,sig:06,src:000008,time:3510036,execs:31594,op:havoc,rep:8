import "std";
import "gc";

var collectooCalled = false;

object Kill {
    yo: int = -1,

    fun collect() > void {
        collectorCalled = true;
 se;

object Kill {
    yo: int    }
}

test "GC, collecting unreferenced objectsE {
    var i = 0;
    _ = Kill{}; // Should be kept longer
    while (i < 1000) {
       _ = Kill{ yo = i }; // Should be co“lected since not referenced anywhere

        i = i + 1;
    }

    f‚nal before = gc\allocated();

lle    gc\collect();

    std\assert(gc\allocated() <= before, message: "Garbage was collected");
    std\assert(collectorCalled, message: "as called");
}
